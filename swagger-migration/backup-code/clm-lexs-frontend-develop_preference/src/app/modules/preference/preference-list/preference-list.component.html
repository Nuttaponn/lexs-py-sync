<div class="content-container" [formGroup]="searchCtrl">
  <div class="title-content" fxLayout="row" fxLayoutAlign="start center">
    <h5 class="title-text">รายการสั่งการบุริมสิทธิจำนอง</h5>
  </div>
<hr>

  <mat-tab-group class="tab-group-content" mat-align-tabs="start" (selectedTabChange)="onTabChanged($event)"
    [selectedIndex]="tabIndex">

    <!--รายการสั่งการยื่นบุริมสิทธิจำนอง Tab -->
    <mat-tab label="0">
      <ng-template mat-tab-label>รายการสั่งการยื่นบุริมสิทธิจำนอง</ng-template>
      <div class="content-container search-filter-content">
        <ng-container>
          <!-- preferenceListData1 <span class="link" (click)="actionClick()">Link preferenceDetail</span> -->

          <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between center">
            <div fxFlex="20" fxLayout="row" fxLayoutAlign="start center">
              <h5>ค้นหา</h5>
            </div>
            <div fxFlex="50" fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="end">
              <div fxLayout="column"  class="mx-width-100">
                <mat-form-field class="no-label input-sm-icon search-input-field">
                  <input matInput type="text" placeholder="เลขที่หนังสือสั่งการ" autocomplete="off"
                    formControlName="docnumber_preference" (keyup)="onKeyup($event,0)" (change)="onTextChange(0)"/>
                  <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(0)"> </mat-icon>
                </mat-form-field>
                <spig-error-msg
                *ngIf="searchCtrl.get('docnumber_preference')?.value"
                [control]="searchCtrl.get('docnumber_preference')"
                [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
              </div>
              <div fxLayout="column"  class="mx-width-100">
                <mat-form-field class="no-label input-sm-icon search-input-field placeholder-black-100">
                  <input matInput type="text" placeholder="เลขที่กฎหมาย" autocomplete="off" formControlName="litigationId_preference"  (keyup)="onKeyup($event,0)"
                  (change)="onTextChange(0)"/>
                  <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(0)"> </mat-icon>
                </mat-form-field>
                <spig-error-msg
                *ngIf="searchCtrl.get('litigationId_preference')?.value"
                [control]="searchCtrl.get('litigationId_preference')"
                [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
      <div class="data-table-content">
        <ng-container
          *ngTemplateOutlet="preferenceData.length === 0 ? searchEmpty : mainTable; context: { list: preferenceData }">
        </ng-container>
        <spig-paginator *ngIf="preferenceData.length > 0 && preferencePageResultConfig && preferencePageActionConfig"
          [result]="preferencePageResultConfig" [action]="preferencePageActionConfig"
          (pageEvent)="pageEvent($event, tabIndex)">
        </spig-paginator>
      </div>
    </mat-tab>

    <!--รายการสั่งการไม่ยื่นบุริมสิทธิจำนอง Tab -->
    <mat-tab label="1">
      <ng-template mat-tab-label>รายการสั่งการไม่ยื่นบุริมสิทธิจำนอง</ng-template>
      <div class="content-container search-filter-content">
        <ng-container>
          <!-- preferenceListData1 <span class="link" (click)="actionClick()">Link preferenceDetail</span> -->

          <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between center">
            <div fxFlex="20" fxLayout="row" fxLayoutAlign="start center">
              <h5>ค้นหา</h5>
            </div>
            <div fxFlex="50" fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="end">
              <div fxLayout="column"  class="mx-width-100">
              <mat-form-field class="no-label input-sm-icon search-input-field placeholder-black-100 normal-text-size">
                <input matInput type="text" placeholder="เลขที่หนังสือสั่งการ" autocomplete="off"
                  formControlName="docnumber_not_preference"  (keyup)="onKeyup($event,1)" (change)="onTextChange(1)"/>
                  <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(1)"> </mat-icon>
              </mat-form-field>
              <spig-error-msg
              *ngIf="searchCtrl.get('docnumber_not_preference')?.value"
              [control]="searchCtrl.get('docnumber_not_preference')"
              [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
            </div>
            <div fxLayout="column"  class="mx-width-100">
              <mat-form-field class="no-label input-sm-icon search-input-field placeholder-black-100 normal-text-size">
                <input matInput type="text" placeholder="เลขที่กฎหมาย" autocomplete="off" formControlName="litigationId_not_preference"  (keyup)="onKeyup($event,1)"
                (change)="onTextChange(1)"/>
                <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(1)"> </mat-icon>
              </mat-form-field>
              <spig-error-msg
              *ngIf="searchCtrl.get('litigationId_not_preference')?.value"
              [control]="searchCtrl.get('litigationId_not_preference')"
              [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
            </div>
            </div>

          </div>
        </ng-container>
      </div>
      <div class="data-table-content">
        <ng-container
          *ngTemplateOutlet="nonpreferenceData.length === 0 ? searchEmpty : mainTable; context: { list: nonpreferenceData }">
        </ng-container>
        <spig-paginator *ngIf="nonpreferenceData.length > 0 && nonpreferencePageResultConfig && nonpreferencePageActionConfig"
          [result]="nonpreferencePageResultConfig" [action]="nonpreferencePageActionConfig"
          (pageEvent)="pageEvent($event, tabIndex)">
        </spig-paginator>
      </div>
    </mat-tab>

    <!--รายการสั่งการบุริมสิทธิจำนองทั้งหมด Tab -->
    <mat-tab label="2">
      <ng-template mat-tab-label>รายการสั่งการบุริมสิทธิจำนองทั้งหมด</ng-template>
      <div class="content-container search-filter-content">
        <ng-container>
          <!-- preferenceListData1 <span class="link" (click)="actionClick()">Link preferenceDetail</span> -->

          <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="space-between center">
            <div fxFlex="20" fxLayout="row" fxLayoutAlign="start center">
              <h5>ค้นหา</h5>
            </div>
            <div fxFlex="75" fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="end">
              <div fxLayout="column"  class="mx-width-100">
                <mat-form-field class="no-label input-sm-icon search-input-field placeholder-black-100 normal-text-size">
                  <input matInput type="text" placeholder="เลขที่หนังสือสั่งการ" autocomplete="off"
                    formControlName="docnumber_all"  (keyup)="onKeyup($event,2)" (change)="onTextChange(2)"/>
                    <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(2)"> </mat-icon>
                </mat-form-field>
                <spig-error-msg
                *ngIf="searchCtrl.get('docnumber_all')?.value"
                [control]="searchCtrl.get('docnumber_all')"
                [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
              </div>
              <div fxLayout="column"  class="mx-width-100">
                <spig-dropdown classInput="input-xsm icon" [config]="ddlDocTypeConfig" [options]="ddlDocType"
                  formControlName="doctype" (selectedOption)="onSelectedOption()">
                </spig-dropdown>
              </div>
              <div fxLayout="column"  class="mx-width-100">
                <mat-form-field class="no-label input-sm-icon search-input-field placeholder-black-100 normal-text-size">
                  <input matInput type="text" placeholder="เลขที่กฎหมาย" autocomplete="off" formControlName="litigationId_all"  (keyup)="onKeyup($event,2)"
                  (change)="onTextChange(2)"/>
                  <mat-icon matSuffix class="icon icon-small-xm" svgIcon="icon-Search" (click)="onSearch(2)"> </mat-icon>
                </mat-form-field>
                <spig-error-msg
                *ngIf="searchCtrl.get('litigationId_all')?.value"
                [control]="searchCtrl.get('litigationId_all')"
                [customErrorMsg]="'SEARCH_CONTROL.ERROR_SEARCH_CONDITION'"></spig-error-msg>
              </div>
            </div>

          </div>
        </ng-container>
      </div>
      <div class="data-table-content">
        <ng-container
          *ngTemplateOutlet="allpreferenceData.length === 0 ? searchEmpty : mainTable; context: { list: allpreferenceData }">
        </ng-container>
        <spig-paginator *ngIf="allpreferenceData.length > 0 && allpreferencePageResultConfig && allpreferencePageActionConfig"
          [result]="allpreferencePageResultConfig" [action]="allpreferencePageActionConfig"
          (pageEvent)="pageEvent($event, tabIndex)">
        </spig-paginator>
      </div>
    </mat-tab>


  </mat-tab-group>
</div>
<ng-template #mainTable let-dataSource="list">
  <div class="table-scroll section" table-scroll>
    <table mat-table [dataSource]="dataSource">
      <ng-container matColumnDef="no">
        <th mat-header-cell *matHeaderCellDef>
          ลำดับ
        </th>
        <td mat-cell *matCellDef="let element; let i = index">
          {{ i + 1 }}
        </td>
      </ng-container>
      <ng-container matColumnDef="docno">
        <th mat-header-cell *matHeaderCellDef class="new-line">
          เลขที่หนังสือสั่งการ
        </th>
        <td mat-cell *matCellDef="let element">
          <ng-container>
            <div class="link" (click)="actionClick(element.preferenceGroupNo)">
              {{element.preferenceGroupNo||'-' }}
            </div>
          </ng-container>
        </td>
      </ng-container>
      <ng-container matColumnDef="docref">
        <th mat-header-cell *matHeaderCellDef class="new-line">
          เลขที่อ้างอิง
        </th>
        <td mat-cell *matCellDef="let element">
          <ng-container>
            <div [class]="element.preferenceNo?'link':''" (click)="actionClick(element.preferenceGroupNo)">
              {{element.preferenceNo||'-' }}
            </div>
          </ng-container>
        </td>
      </ng-container>
      <ng-container matColumnDef="docdate">
        <th mat-header-cell *matHeaderCellDef >
          วันที่สั่งการ
        </th>
        <td mat-cell *matCellDef="let element" >
          {{(element.createdDate| buddhistEra: 'DD/MM/YYYY')||'-' }}
        </td>
      </ng-container>
      <ng-container matColumnDef="doctype">
        <th mat-header-cell *matHeaderCellDef >
          ประเภทหมาย
        </th>
        <td mat-cell *matCellDef="let element">
          {{element.executeTypeName||'-' }}
        </td>
      </ng-container>
      <ng-container matColumnDef="doctype2">
        <th mat-header-cell *matHeaderCellDef >
          ประเภทหนังสือสั่งการ
        </th>
        <td mat-cell *matCellDef="let element" >
          {{element.executeCaseTypeName||'-' }}
        </td>
      </ng-container>
      <ng-container matColumnDef="username">
        <th mat-header-cell *matHeaderCellDef >
          ผู้สั่งการ
        </th>
        <td mat-cell *matCellDef="let element" >
          {{element.createdBy +'-'+element.createdByFullName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="preferenceno">
        <th mat-header-cell *matHeaderCellDef >
          เลขที่กฎหมาย
        </th>
        <td mat-cell *matCellDef="let element" >
          <div [class]="element.preferenceNo?'link':''" (click)="navigateToLitigation(element.litigationId)">
      {{element.litigationId||'-' }}
            </div>
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="status" stickyEnd>
        <th mat-header-cell *matHeaderCellDef >
          สถานะ
        </th>
        <td mat-cell *matCellDef="let element" >
          <div
                [class]="element.preferenceStatusName?'status-label size-xl status-normal text-left':''"
                fxLayout="row"
                fxLayoutAlign="space-between center">
                {{ element.preferenceStatusName||'-' }}
              </div>
        </td>
      </ng-container> -->

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</ng-template>

<ng-template #searchEmpty>
  <div class="table-scroll" table-scroll>
    <table mat-table>
      <ng-container matColumnDef="no">
        <th mat-header-cell *matHeaderCellDef >
          ลำดับ
        </th>
      </ng-container>
      <ng-container matColumnDef="docno">
        <th mat-header-cell *matHeaderCellDef >
          เลขที่หนังสือสั่งการ
        </th>
      </ng-container>
      <ng-container matColumnDef="docref">
        <th mat-header-cell *matHeaderCellDef >
          เลขที่อ้างอิง
        </th>
      </ng-container>
      <ng-container matColumnDef="docdate">
        <th mat-header-cell *matHeaderCellDef >
          วันที่สั่งการ
        </th>
      </ng-container>
      <ng-container matColumnDef="doctype">
        <th mat-header-cell *matHeaderCellDef >
          ประเภทหมาย
        </th>
      </ng-container>
      <ng-container matColumnDef="doctype2">
        <th mat-header-cell *matHeaderCellDef >
          ประเภทหนังสือสั่งการ
        </th>
      </ng-container>
      <ng-container matColumnDef="username">
        <th mat-header-cell *matHeaderCellDef >
          ผู้สั่งการ
        </th>
      </ng-container>
      <ng-container matColumnDef="preferenceno">
        <th mat-header-cell *matHeaderCellDef >
          เลขที่กฎหมาย
        </th>
      </ng-container>
      <!-- <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef >
          สถานะ
        </th>
      </ng-container> -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    </table>
  </div>
  <div>
    <app-message-empty [message]="'ไม่พอข้อมูล'"></app-message-empty>
  </div>
</ng-template>
